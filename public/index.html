<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>VR-Vocab</title>
    <!-- blank favicon -->
    <link href="data:image/x-icon;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQEAYAAABPYyMiAAAABmJLR0T///////8JWPfcAAAACXBIWXMAAABIAAAASABGyWs+AAAAF0lEQVRIx2NgGAWjYBSMglEwCkbBSAcACBAAAeaR9cIAAAAASUVORK5CYII="
          rel="icon" type="image/x-icon"/>
    <link href="assets/font-kit/stylesheet.css" rel="stylesheet">
    <script src="https://aframe.io/releases/1.1.0/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-look-at-component@0.8.0/dist/aframe-look-at-component.min.js"></script>
    <script src="https://unpkg.com/aframe-environment-component@2.0.0/dist/aframe-environment-component.min.js"></script>
    <script src="https://unpkg.com/aframe-text-geometry-component@^0.5.0/dist/aframe-text-geometry-component.min.js"></script>
    <!-- slice9: Create panels and backgrounds. -->
    <script src="https://unpkg.com/aframe-slice9-component@1.0.0/dist/aframe-slice9-component.min.js"></script>
    <!--- rendering of transparencies of nested objects -->
    <script src="https://unpkg.com/aframe-render-order-component@1.0.0/dist/aframe-render-order-component.min.js"></script>
    <!-- layout: Arrange and position entities automatically, eg in a circle -->
    <script src="https://unpkg.com/aframe-layout-component@5.3.0/dist/aframe-layout-component.min.js"></script>
    <!-- proxy-event: Declaratively capture and event and reroute it to another entity. -->
    <script src="https://unpkg.com/aframe-proxy-event-component@2.1.0/dist/aframe-proxy-event-component.min.js"></script>
    <!-- state: Manage application state and bind it to parts of the application to automatically react to state changes. -->
    <script src="https://unpkg.com/aframe-state-component@6.6.0/dist/aframe-state-component.js"></script>
    <script src="aframe-gui.js"></script>
    <script src="aframe-troika-text.js"></script>


    <!-- backend communication to node for language data (for now) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.7.3/socket.io.js"></script>
    <script src="https://unpkg.com/lodash@4/lodash.min.js"></script>
    <script src="https://unpkg.com/lowdb@0.17/dist/low.min.js"></script>
    <script src="https://unpkg.com/lowdb@0.17/dist/LocalStorage.min.js"></script>


    <!-- State definition. -->
    <script src="state.js"></script>
    <!-- a game definition, attach to scene? -->
    <script src="client.js" defer></script>
    <!-- ui layer !--->
    <script src="aframespots.js"></script>
</head>
<body>
<!-- load the font for canvas -->
<div style="font-family: 'Fira Sans'; font-weight:500; font-style: normal; height: 1px">&nbsp;</div>
<div style="font-family: 'Signika';  font-style: normal; height: 1px">&nbsp;</div>
<div style="font-family: 'Permanent Marker';  font-style: normal; height: 1px">&nbsp;</div>
<div style="font-family: 'Schoolbell';  font-style: normal; height: 1px">&nbsp;</div>
<a-scene renderer="sortObjects: false;antialias: auto; highRefreshRate: true; alpha:false" render-order="layer1,object,layer2,text,layer3,icon,layer4,layer5">
    <a-assets>
        <a-asset-item id="star" src="assets/star.glb"></a-asset-item>
        <a-asset-item id="whiteboard" src="assets/whiteboard.glb"></a-asset-item>
        <img id="cardboard" src="assets/cardboard.jpg">
        <img id="cardboard-NRM" src="assets/cardboard_normal.jpg">

        <img id="kitchen" src="photos/kitchen.jpg" />
        <img id="gourmet" src="photos/gourmet.jpg" />
        <img id="viewpoint" src="photos/viewpoint.jpg" />
        <img id="home-office" src="photos/home-office.jpg" />

        <a-asset-item id="dawningFont" src="assets/dawningOfANewDayRegular.typeface.json"></a-asset-item>
        <a-asset-item id="exoFont" src="assets/exo2Black.typeface.json"></a-asset-item>
        <a-asset-item id="exoItalicFont" src="assets/exo2BlackItalic.typeface.json"></a-asset-item>

        <!-- cant seem to preload fonts from another domain or something but you can use them as mixins which is neater if not faster -->
        <a-mixin id="blackboard-font" text="font: https://raw.githubusercontent.com/etiennepinchon/aframe-fonts/master/fonts/caveatbrush/CaveatBrush-Regular.json; shader: msdf;"></a-mixin>
        <a-mixin id="whiteboard-font" text="font: https://raw.githubusercontent.com/etiennepinchon/aframe-fonts/master/fonts/schoolbell/Schoolbell-Regular.json; shader: msdf;"></a-mixin>
        <a-mixin id="marker-font" text="font: https://raw.githubusercontent.com/etiennepinchon/aframe-fonts/master/fonts/permanentmarker/PermanentMarker-Regular.json; shader: msdf;"></a-mixin>
        <audio
                id="correct"
                src="audio/grunz-success.mp3"
        ></audio>
        <audio
                id="incorrect"
                src="audio/duck-quack.mp3"
        ></audio>
        <a-mixin id="home" bind__visible="location === 'come'"></a-mixin>
        <!--- from kevin ngo's menu example -->
        <!-- Images. -->
        <img id="sliceImg" src="https://cdn.glitch.com/0ddef241-2c1a-4bc2-8d47-58192c718908%2Fslice.png?1557308835598" crossorigin>

        <!-- Base mixins. -->
        <a-mixin id="slice" slice9="color: #050505; transparent: true; opacity: 1; src: #sliceImg; left: 50; right: 52; top: 50; bottom: 52; padding: 0.15"></a-mixin>

        <a-mixin id="button" bind__class="homeFusable" width="1.2" height="0.35" font-family="Signika" font-size="100px" margin="0.4 0 0 0"
                 border-color="#cc0000" hover-color="#00cc00" background-color="#0000cc" active-color="pink"></a-mixin>

    </a-assets>
    <a-entity id="myRig">
        <!--this is used to rotate the boxes towards the camera -->
        <a-entity id="boxfaces" position="0 1 0"></a-entity>
        <a-entity id="head" camera look-controls wasd-controls position="0 1.6 0">
            <!-- HUD elements !-->
            <a-text id="hud-top" class="hud" text="align: center; width: 2;  color: #FFFFFF;"
                    bind__value="hudTextTOP" position="0 1 -3" rotation="20 0 0" opacity="0.85" wrap-count="20"></a-text>
            <a-text id="hud-mid" class="hud" text="align: center; width: 4; color: navy;"
                    bind__value="hudTextMID" position="0 -.1 -6" opacity="1" wrap-count="20"  material="color: #eee"
                    animation="property:text.opacity; from:1; to: 0;  dur:5000; autoplay: false; startEvents: mouseEnter"
                    event-set__clear="_event: animationcomplete; text.value: "
            ></a-text>
            <a-text id="hud-bot" class="hud" text="align: center; width: 2;  color: #FFFFFF;" bind__value="hudTextBOT"
               position="0 -.75 -3" opacity="0.85" rotation="-20 0 0" wrap-count="20"></a-text>

            <a-gui-cursor id="hud-cursor"
                          raycaster="objects: .fusable"
                          fuse="true" fuse-timeout="2000"
                          design="cross"
                          distance="-3"
                          scaling="2"
                          interval="50"
                          cursor-listen>
            </a-gui-cursor>

        </a-entity>
    </a-entity>
    <!-- Home interface -->

    <a-entity id="environment" environment="preset: forest;" bind__environment="active: location == 'home'"></a-entity>


    <a-sphere bind__visible="location == 'home'" id="img_gourmet"  material="src: #gourmet; opacity:0.5" position="4 1.62 -.012" radius=".4" animation__enter="property: rotation; from: 0 0 0; to: 0 360 0; dur: 10000; easing: linear; loop; autoplay: false" geometry="radius: 0.35"></a-sphere>

    <a-box bind__visible="location == 'home'" id="box_gourmet" scale="0.5 1.3 1" material="opacity:.8; src:#cardboard; normal-map: #cardboard-NRM;" position="4 0.625 0"></a-box>
    <a-plane id="text_gourmet" material="color: #ffffff; shader: flat; opacity: 0" scale="" position="3.74 0.7 0" rotation="0 -90 0" text="color: black; align: center; value: GOURMET\n\n words: 46\nfound: 0; wrapCount: 20" geometry="" bind__visible="location == 'home'"></a-plane>



    <a-entity look-at="#boxfaces" render-order="object" bind__visible="location == 'home'" text="value: Front" id="box_kitchen" geometry="primitve:box; width:1; height:1.3; depth:.5;" scale="1 1 1" material="opacity:.8; src:#cardboard; normal-map: #cardboard-NRM;"  position="3.81789 0.625 -1.32335" rotation="0 -85 0">
        <a-sphere render-order="object" id="img_kitchen" material="src: #kitchen; opacity:.5" position="0 1 0" radius=".4" animation__enter="property: rotation; from: 0 0 0; to: 0 360 0; dur: 10000; easing: linear; loop: true; autoplay: false" geometry="radius: 0.35"></a-sphere>
        <a-troika-text id="text_kitchen" render-order="text" position="0 0 0.27"
                       troika-text-material="shader: flat; opacity: 0;"
                       font="assets/font-kit/Signika-Regular.ttf"
                       align="center"
                       color="#000000"
                       value="KITCHEN\n\n words: 22\nfound: 0"
                       line-height="1.1"
                       baseline="bottom"
                       font-size=".1">
        </a-troika-text>
        <a-troika-text render-order="text" position="0 0.2 0.3"
                       font="assets/font-kit/PermanentMarker-Regular.ttf"
                       font-size=".25"
                       value="locked"
                       color="white"
                       rotation="0 0 50">
            </a-troika-text>
        </a-troika-text>
        <a-entity bind__visible="location == 'home'" id="star" gltf-model="assets/star.glb" position="-.285 -.82 .9"></a-entity>
        <a-entity bind__visible="location == 'home'" id="star" gltf-model="assets/star.glb" position="0.01 -.82 .9"></a-entity>
        <a-entity bind__visible="location == 'home'" id="star" gltf-model="assets/star.glb" position=".29 -.82 .9"></a-entity>v
    </a-entity>

    <a-entity vocab-level src="#kitchen" stars="2" box-text="KITCHEN\n\n words: 22\nfound: 0" position="1 .625 -3"></a-entity>


    <a-sphere bind__visible="location == 'home'" vocab-room bind__class="homeFusable" id="img_homeoffice" material="src: #home-office" position="3.5791 1.62 -2.52019" radius=".4"
              animation__enter="property: rotation; from: 0 0 0; to: 0 360 0; dur: 15000; easing: linear; loop:false; autoplay: false; startEvents: mouseenter;"
              geometry="radius: 0.35"
              sound="#slidechange" ></a-sphere>
    <a-entity bind__visible="location == 'home'"  vocab-room bind__class="homeFusable" id="box_homeoffice" geometry="" scale="0.5 1.3 1" material="src:#cardboard; normal-map: #cardboard-NRM;" position="3.52542 0.625 -2.52875" rotation="0 20 0">
    </a-entity>
    <a-plane bind__visible="location == 'home'" id="text_homeoffice" material="color: #ffffff; shader: flat; opacity: 0" scale="" position="3.27354 0.7 -2.44478" rotation="0 -70 0" text="color: black; align: center; value: HOME OFFICE\n\n words: 34\nfound: 15; wrapCount: 20" geometry="">
    </a-plane>
    <a-entity bind__visible="location == 'home'" id="star" gltf-model="assets/star.glb" position="2.63352 -0.2 -2.43691" rotation="3.990651043086184 -62.63058954354542 -1.3309809580889025"></a-entity>

    <a-light bind__visible="location == 'home'" type="spot" position="0.69554 2.43826 -0.75504" color="white" target="#text_kitchen" distance="10" intensity="0.7" light="target: #text_kitchen"></a-light>


    <!--- black board , slice 9 for a rounded panel and then text / buttons on top-->
    <a-entity position="1.9 3.2 -5.5" mixin="slice" slice9="height: 4; width: 3.5; color: #171717; opacity:0.9"
              bind__visible="location == 'home'" rotation="10 -15 0">
    </a-entity>
    <a-troika-text position = "1.9 4.181 -5.3" rotation="10 -15 0" bind__visible="location == 'home'"
                   troika-text-material="shader: flat; opacity: 0"
                   font="assets/font-kit/Signika-Regular.ttf"
                   max-width="2.9"
                   line-height="1.5"
                   font-size=".16"
                   align="center"
                   color="#FFFFFF"
                   bind__troika-text="value: uiText.welcome">
    </a-troika-text>
    <!-- button colors are overriden with grey, it takes the first set of colors -->
    <a-gui-flex-container bind__visible="location == 'home'"
                          flex-direction="column" justify-content="left" item-padding="0.1" opacity="0" width="3.4" height="3"
                          position="1.9 2.2 -5.5" rotation="10 -15 0">
        <a-gui-flex-container flex-direction="row" width="3.4" height=".6" justify-content="left">
            <a-gui-label
                    width="1.8" height="0.75" font-color="#fcfcfc" font-family="Signika" font-size="100px" opacity="0" margin="0 0 0 0"
                    value="Game Mode:">
            </a-gui-label>
            <a-gui-button
                    bind__class="homeFusable" width="1.2" height="0.35" font-family="Signika" font-size="100px" margin="0.4 0 0 0"
                    border-color="#8f4f00" hover-color="#331c00" background-color="#111111" active-color="#FF8C00"
                    border-color="#FF8C00" active-color="#FF8C00" hover-color="#444444" background-color="#111111"
                    bind__value="gameMode" proxy-event="event: click; to: a-scene; as: changeMode">
            </a-gui-button>
        </a-gui-flex-container>
        <a-gui-flex-container flex-direction="row" width="3.4" height=".6" justify-content="left">
            <a-gui-label
                    width="1.8" height="0.75" font-color="#fcfcfc" font-family="Signika" font-size="100px" opacity="0" margin="0 0 0 0"
                    value="Words per Game:">
            </a-gui-label>
            <a-gui-button
                    bind__class="homeFusable" width="1.2" height="0.35" font-family="Signika" font-size="100px" margin="0.4 0 0 0"
                    border-color="#666666" hover-color="#333333" background-color="#111111" active-color="#FF8C00"
                    border-color="#03b800" hover-color="#3c3c3c" active-color="#03b800" background-color="#333333"
                    bind__value="wordsPerGame" proxy-event="event: click; to: a-scene; as: changeWordsPerGame">
            </a-gui-button>
        </a-gui-flex-container>
        <a-gui-flex-container flex-direction="row" width="3.4" height=".6" justify-content="left">
            <a-gui-label
                    width="1.8" height="0.75" font-color="#fcfcfc" font-family="Signika" font-size="100px" opacity="0" margin="0 0 0 0"
                    value="Player:">
            </a-gui-label>
            <a-gui-button
                    bind__class="homeFusable" width="1.2" height="0.35" font-family="Signika" font-size="100px" margin="0.4 0 0 0"
                    border-color="#666666" hover-color="#333333" background-color="#111111" active-color="#FF8C00"
                    proxy-event="event: click; to: a-scene; as: changeUser"
                    bind__value="userName">
            </a-gui-button>
        </a-gui-flex-container>
    </a-gui-flex-container>


<!-- whiteboard for statistics-->
    <a-entity bind__visible="location == 'home'" id="board" gltf-model="#whiteboard" position="-3.45 0 -.5" rotation="0 -25 0"></a-entity>
    <a-plane bind__visible="location == 'home'" id="wbtext" material="color: #FFFFFF; shader: flat" scale="1.9 1.1 1" position="-3.4048 1.49655 -0.47111" rotation="0 65 0"
             mixin = "whiteboard-font"
             text="width: 1; color: navy; align: center; lineHeight:55;
             value: YOUR PROGRESS\n\nItems Discovered: 15\nLevels unlocked: 0\nNumber of Stars: 1\nBest Time: 01:35s\nWorld Rank: 11,248\n\nKeep up the good work!; wrapCount: 30" >
    </a-plane>

    <!-- logo -->
    <a-entity bind__visible="location == 'home'" id="logo" rotation="0 20 0" position="-5.1448 0.5 -4.49608" scale="0.37658 0.75972 0.63311" text-geometry="value: VR VOCAB; font: #exoFont; bevelEnabled: true; bevelSize: 0.1; bevelThickness: 0.1; curveSegments: 1; size: 1.5; height: 0.5" material="color: #ae00ff; metalness: 0.9; roughness: 0.48; emissive: #242323" ></a-entity>
    <a-entity bind__visible="location == 'home'" position="-4.3 0.36 -4.2" scale=".5 .5 .5" rotation="0 17.5 0"  text-geometry="value: Welcome; font: #exoItalicFont; style: italic; size: 0.8; weight: bold; height: 0" material="color: #03b800"></a-entity>
    <a-entity bind__visible="location == 'home'" position="-4.3 0.36 -4.2" scale=".5 .5 .5" rotation="0 17.5 0"  text-geometry="value: Welcome; font: #exoItalicFont; style: italic; size: 0.8; weight: bold; height: 0; bevelEnabled: true; bevelSize: 0.04; bevelThickness: 0.04; curveSegments: 1" material="shader: flat; color: #475248; transparent: true; opacity: 0.2"></a-entity>
    <a-entity bind__visible="location == 'home'" position="-3.31008 3.13324 -0.19125" light="color: #ffaaff; type: spot; intensity: 1.5; target: #logo; distance: 9.99; penumbra: 1"></a-entity>

    <a-sky id="sky" bind__visible="location == 'photo'" ></a-sky>
</a-scene>

</body>
</html>